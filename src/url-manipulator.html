<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>1.2. URL Manipulation Tool</title>
    </head>
    <body>
        <form action="" id="form">
            <label for="protocol">Chọn giao thức</label>
            <select name="protocol" id="protocol">
                <option value="http:">http</option>
                <option value="https:">https</option>
            </select>

            <label for="hostname">Hostname</label>
            <input
                type="text"
                id="hostname"
                placeholder="ví dụ: google.com"
                required
            />

            <label for="port">Port</label>
            <input
                type="number"
                id="port"
                placeholder="ví dụ: 3000, có thể để trống"
            />

            <label for="pathname">Pathname</label>
            <input
                type="text"
                id="pathname"
                placeholder="ví dụ: /products/detail"
            />

            <label for="search">Search/Query</label>
            <input
                type="text"
                id="search"
                placeholder="ví dụ: ?id=123&name=abc"
            />

            <label for="hash">Hash</label>
            <input type="text" id="hash" placeholder="ví dụ: #section1" />

            <div class="btn-wrap">
                <button class="btn navigate-btn">Navigate</button>
                <button class="btn replace-btn">Replace</button>
                <button class="btn reload-btn">Reload</button>
            </div>
        </form>
        <script type="module" src="./main.js"></script>
        <script>
            const protocol = document.querySelector("#protocol");
            const hostname = document.querySelector("#hostname");
            const port = document.querySelector("#port");
            const pathname = document.querySelector("#pathname");
            const search = document.querySelector("#search");
            const hash = document.querySelector("#hash");
            const navigateBtn = document.querySelector(".navigate-btn");
            const replaceBtn = document.querySelector(".replace-btn");
            const reloadBtn = document.querySelector(".reload-btn");
            const form = document.querySelector("#form");

            function normalizePathname(path) {
                if (!path) return ""; // Nếu trống thì trả về ""
                path = path.trim();
                if (path === "/") return "/"; // Nếu người dùng chỉ nhập "/" thì giữ nguyên
                return path.startsWith("/") ? path : "/" + path; // Nếu thiếu "/" thì thêm vào đầu
            }

            function normalizeSearch(q) {
                if (!q) return "";
                q = q.trim();
                if (!q) return "";
                return q.startsWith("?") ? q : "?" + q;
            }

            function normalizeHash(h) {
                if (!h) return "";
                h = h.trim();
                if (!h) return "";
                return h.startsWith("#") ? h : "#" + h;
            }

            // Hàm lấy ra đường dẫn
            function getURL() {
                return `${protocol.value}//${hostname.value.trim()}${
                    port.value ? ":" + port.value : ""
                }${normalizePathname(pathname.value)}${normalizeSearch(
                    search.value
                )}${normalizeHash(hash.value)}`;
            }

            form.addEventListener("submit", (e) => {
                e.preventDefault();
            });

            navigateBtn.addEventListener("click", () => {
                location.assign(getURL());
            });

            replaceBtn.addEventListener("click", () => {
                location.replace(getURL());
            });

            reloadBtn.addEventListener("click", () => {
                location.reload();
            });
        </script>
    </body>
</html>
